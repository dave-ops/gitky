<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Web Viewer</title>
</head>
<body>
    <h1>Git Web Viewer</h1>
    <form action="/prepare-clone" method="post">
        <label for="repoUrl">Enter GitHub Repository URL:</label><br>
        <input type="text" id="repoUrl" name="repoUrl" required><br><br>
        <label for="action">If the repository exists:</label>
        <select name="action" id="action">
            <option value="delete">Delete it</option>
            <option value="rename">Rename it</option>
        </select><br><br>
        <input type="submit" value="Prepare Clone">
    </form>
    <script>
        document.querySelector('form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const response = await fetch('/prepare-clone', {
                method: 'POST',
                body: formData
            });
            const text = await response.text();
            alert(text);
            if (text.includes('Proceed with cloning')) {
                const cloneResponse = await fetch('/clone', {
                    method: 'POST',
                    body: formData
                });
                const cloneText = await cloneResponse.text();
                document.body.innerHTML = cloneText;
            }
        });
    </script>
</body>
</html>